<% content_for :title, @mtitle %>
<% content_for :description, @mdescription %>

<div class="container-fluid px-0">
  <!-- Header Section -->
  <section class="bg-light py-5">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-8 text-center">
          <h1 class="display-4 fw-bold mb-4">Client Reviews & Testimonials</h1>
          <p class="lead text-muted mb-4">
            Read genuine reviews from our satisfied clients across Spain and the Canary Islands. 
            See why UK, Irish & international property buyers trust Roper Lawyers for their Spanish property transactions.
          </p>
          
          <!-- Google Reviews Link -->
          <div class="mb-4">
            <a href="https://www.google.com/maps/place/Roper+Lawyers/@28.9208706,-13.6682914,17z/data=!4m8!3m7!1s0xc4625151db852d7:0x4e4d25ec171214f4!8m2!3d28.9208706!4d-13.6657165!9m1!1b1!16s%2Fg%2F11hdxxw7zb?entry=ttu&g_ep=EgoyMDI1MDkxMC4wIKXMDSoASAFQAw%3D%3D" 
               target="_blank" rel="noopener noreferrer"
               class="btn btn-lg rounded-pill px-4" style="background-color: #b39c84; border-color: #b39c84; color: white;">
              <i class="fa-brands fa-google me-2"></i>
              View All Google Reviews
            </a>
          </div>
          
          <!-- Rating Summary -->
          <div class="d-flex justify-content-center align-items-center gap-3 mb-4">
            <div class="text-center">
              <div class="h2 mb-0 d-flex justify-content-center">
                <svg width="24" height="24" viewBox="0 0 24 24" class="me-1" fill="#FBBC04">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
                <svg width="24" height="24" viewBox="0 0 24 24" class="me-1" fill="#FBBC04">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
                <svg width="24" height="24" viewBox="0 0 24 24" class="me-1" fill="#FBBC04">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
                <svg width="24" height="24" viewBox="0 0 24 24" class="me-1" fill="#FBBC04">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="#FBBC04">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
              </div>
              <p class="mb-0 text-muted">5.0 out of 5 stars</p>
            </div>
            <div class="text-center">
              <div class="h3 mb-0 fw-bold" style="color: #b39c84;">80+</div>
              <p class="mb-0 text-muted">Happy Clients</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Reviews Section -->
  <section class="py-5">
    <div class="container">
      <div class="row g-4">
        <% if @reviews && @reviews["records"] %>
          <% @reviews["records"].each do |review| %>
            <div class="col-lg-4 col-md-6">
              <div class="card h-100 shadow-sm border-0">
                <div class="card-body p-4">
                  <!-- Rating -->
                  <div class="mb-3 d-flex">
                    <% review["rating"].to_i.times do %>
                      <svg width="16" height="16" viewBox="0 0 24 24" class="me-1" fill="#FBBC04">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                      </svg>
                    <% end %>
                  </div>
                  
                  <!-- Review Content -->
                  <div class="comment-box mb-3" data-controller="review">
                    <% if review["comment"] && review["comment"].length > 200 %>
                      <p class="card-text" data-review-target="comment" 
                         data-full="<%= h review["comment"] %>" 
                         data-truncated="<%= h truncate(review["comment"], length: 200) %>">
                        <%= truncate(review["comment"], length: 200) %>
                      </p>
                      <a href="#" data-review-target="moreLink" data-action="review#showFull" 
                         class="text-decoration-none small fw-bold" style="color: #b39c84;">Read More</a>
                      <a href="#" data-review-target="lessLink" data-action="review#showTruncated" 
                         class="text-decoration-none small fw-bold d-none" style="color: #b39c84;">Show Less</a>
                    <% else %>
                      <p class="card-text"><%= review["comment"] %></p>
                    <% end %>
                  </div>
                  
                  <!-- Client Name -->
                  <div class="border-top pt-3">
                    <h6 class="mb-0 fw-bold text-dark"><%= review["name"] %></h6>
                    <small class="text-muted">Verified Client</small>
                  </div>
                </div>
              </div>
            </div>
          <% end %>
        <% else %>
          <div class="col-12 text-center py-5">
            <p class="text-muted">Reviews are currently being loaded. Please check back soon.</p>
          </div>
        <% end %>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="text-white py-5" style="background-color: #b39c84;">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-8 text-center">
          <h3 class="mb-3">Ready to Join Our Happy Clients?</h3>
          <p class="lead mb-4">
            Get expert legal guidance for your Spanish property transaction. 
            Free consultation with our bilingual legal team.
          </p>
          <div class="d-flex flex-column flex-sm-row gap-3 justify-content-center">
            <a href="/free-consultation" class="btn btn-light btn-lg rounded-pill px-4">
              Book Free Consultation
            </a>
            <a href="tel:+442081358218" class="btn btn-outline-light btn-lg rounded-pill px-4">
              <i class="fa fa-phone me-2"></i>
              Call UK: +44 20 8135 8218
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
